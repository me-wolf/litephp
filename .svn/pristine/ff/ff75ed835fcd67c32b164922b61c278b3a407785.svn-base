<?php
class Model_User extends DB_Model {
	public $group_name;

	public function __construct(){
		$filters = array(
			'user_group_id' => array(
				'REQUIRE' => '请选择用户所在分组',
				'NUMBER' => 'ERROR'
			),
			'name' => array(
				'REQUIRE' => '用户名不能为空',
				'MAXLEN' => array('用户名不长于40个字母', 40),
				'MINLEN' => array('用户名必须大于5个字母', 5),
			),
			'password' => array(
				'REQUIRE' => '请输入密码',
				'MINLEN' => array('密码长度不得小于4个字母', 4),
				'MAXLEN' => array('密码长度不得大于32个字母', 32)
			),
			'gender' => array(
				'DEFAULT' => '1'
			),
			'email' => array(
				'EMAIL' => '请输入正确的邮箱格式'
			)
		);
		$this->setFilters($filters);
	}

	protected function __onSetAttribute($key, $val){
		if($key == 'user_group_id'){
			$group = Model_UserGroup::find('id=?',$val)->one();
			$this->group_name = $group->name;
			return false;
		}
	}

	protected function getTableName(){
		return "user";
	}

	protected function getPrimaryKey(){
		return "id";
	}
}