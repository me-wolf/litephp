<?php
class Model_Access{
	const SESS_KEY = 'BE_ACESS_SK';
	private static $ins;
	private function __construct($option=array()){
		session_start();
	}

	public static function init($option=array()){
		if(!self::$ins){
			self::$ins = new self($option);
		}
		return self::$ins;
	}

	public static function setLoginInfo($user_id){
		return $_SESSION[self::SESS_KEY] = $user_id;
	}

	public function getLoginInfo(){
		$user_id = $_SESSION[self::SESS_KEY];
		if($user_id){
			return Model_User::find('id=?',$user_id)->one();
		}
		return null;
	}

	public static function checkLogin(){
		return self::init()->getLoginInfo();
	}

	public function logout(){
		$_SESSION[self::SESS_KEY] = null;
	}
}