<?php
	$mod_id = $mod['mod_id'];
?>
<fieldset class="resume-mod resume-mod-<?php echo $mod_id;?> resume-mod-<?php echo $mod_id;?>-base" <?php echo $mod->invisible ? 'style="display:none"' : ''?>>
	<input type="hidden" name="visibility[<?php echo $mod_id;?>]" value="1" rel="mod-visibility">
	<input type="hidden" name="order[<?php echo $mod_id;?>]" value="0" rel="mod-order">
	<ul class="resume-mod-op-list">
		<?php if(count($mod['templates'])>1):?>
		<li>
			<span class="ti resume-mod-change-temp-btn">模版&#9660;</span>
			<ul rel="template-select">
				<?php foreach($mod['templates'] as $k=>$template):?>
				<li <?php if($k=='base'):?>class="selected"<?php endif;?> rel="template-select" data-class="resume-mod-<?php echo $mod_id;?>-<?php echo $k;?>">
					<span class="tick">√</span>
					<span class="item"><?php echo $template['name']?></span>
				</li>
				<?php endforeach;?>
			</ul>
		</li>
		<?php endif;?>
		<li><a href="javascript:;" class="resume-mod-del-btn" rel="resume-mod-del-btn" data-mod-id="<?php echo $mod_id;?>">删除栏目</a></li>
	</ul>

	<?php $placeholder = $mod['placeholder'] ?: '请输入标题';?>
	<div class="resume-mod-ti">
		<input class="txt" type="text" name="title[<?php echo $mod_id;?>]" value="<?php echo $mod['title'];?>" placeholder="<?php echo $placeholder;?>"/>
	</div>

	<div class="resume-mod-con">
		<?php
			if(!is_array($mod['value'])){
				$mod['value'] = array($mod['value']);
			}
		?>
		<?php foreach($mod['value'] as $value):?>
		<div class="resume-mod-con-instance">
			<?php
			foreach($mod['data'] as $key=>$item){
				$item_id = 'resume-mod-'.$mod_id.'-'.$key;
				$html = '<dl class="'.$item_id.'-item resume-mod-item">';
				$html .= $item['label'] ? '<dt><label for="'.$item_id.'">'.$item['label'].'</label></dt>' : '';
				$html .= '<dd>';
				$name = "data[$mod_id][$key]";
				switch($item['type']){
					//年月
					case 'yearmonth':
						$min_y = date('Y', $item['min']);
						$max_y = date('Y', $item['max']);

						$html .= '<select size="1" id="'.$item_id.'-year" name="'.$name.'[year][]">';
						$html .= '<option value="">请选择</option>';
						for($i=$max_y; $i>=$min_y; $i--){
							$html .= '<option value="'.$i.'">'.$i.'年</option>';
						}
						$html .= '</select>';

						$html .= '<select size="1" id="'.$item_id.'-month" name="'.$name.'[month][]">';
						$html .= '<option value="">请选择</option>';
						for($i=1; $i<=12; $i++){
							$html .= '<option value="'.$i.'">'.$i.'月</option>';
						}
						$html .= '</select>';
						break;

					//描述
					case 'description':
						$ah = $key != 'info' ? 'data-auto-resize="1"' : '';
						$html .= '<textarea name="'.$name.'[]" id="'.$item_id.'" cols="30" rows="10" class="txt txt-description" '.$ah;
						$html .= $item['placeholder'] ? 'placeholder="'.$item['placeholder'].'" ' : '';
						$html .= '></textarea>';
						break;

					//HTML富文本
					case 'html':
						$html .= '<textarea name="'.$name.'[]" id="'.$item_id.'" cols="30" rows="10" class="txt" ';
						$html .= $item['placeholder'] ? 'placeholder="'.$item['placeholder'].'" ' : '';
						$html .= '></textarea>';
						break;

					//日期
					case 'date':
						$html .= '<select size="1" id="'.$item_id.'-year" name="'.$name.'[year][]">';
						for($i=date('Y')-5; $i<=date('Y'); $i++){
							$html .= '<option value="'.$i.'">'.$i.'年</option>';
						}
						$html .= '</select>';

						$html .= '<select size="1" id="'.$item_id.'-month" name="'.$name.'[month][]">';
						for($i=1; $i<=12; $i++){
							$html .= '<option value="'.$i.'">'.$i.'月</option>';
						}
						$html .= '</select>';

						$html .= '<select size="1" id="'.$item_id.'-date" name="'.$name.'[date][]">';
						for($i=1; $i<=31; $i++){
							$html .= '<option value="'.$i.'">'.$i.'日</option>';
						}
						$html .= '</select>';
						break;

					//单选
					case 'radio':
						$name = $item_id;
						foreach($item['options'] as $v=>$lbl){
							$html .= '<label><input type="radio" name="'.$name.'[]" value="'.$k.'" class="radio" /> ';
							$html .= $lbl.'</label> &nbsp;';
						}
						break;

					//列表选择
					case 'select':
						$html .= '<select size="1" name="'.$name.'[]">';
						$html .= '<option value="">请选择</option>';
						foreach($item['options'] as $v=>$lbl){
							$html .= '<option value="'.$v.'">'.$lbl.'</option>';
						}
						$html .= '</select>';
						break;

					//图片
					case 'image':
						$html .= '<div class="resume-avatar">';
						$html .= '<div class="resume-avatar-img">'.$this->getImg($item['value']).'</div>';
						$html .= '<input type="hidden" name="'.$name.'[]" value=""/>';
						$html .= '<input type="button" value="上传照片" class="btn btn-strong" />';
						$html .= '</div>';
						break;

					//字符串或其他
					case 'string':
					default:
						$html .= '<input type="text" name="'.$name.'[]" class="txt txt-string" id="'.$item_id.'" ';
						$html .= $item['placeholder'] ? 'placeholder="'.$item['placeholder'].'" ' : '';
						$html .= '/>';
						break;
				}
				$html .= '</dd></dl>';
				echo $html;
			}
			?>

			<?php if($mod['multi_instance']):?>
			<div class="resume-mod-instance-op">
				<!-- <a href="" class="resume-mod-clone-instance-btn">复制</a> -->
				<a href="" class="resume-mod-remove-instance-btn">删除</a>
			</div>
			<?php endif;?>
		</div>
		<?php endforeach;?>
	</div>

	<?php if($mod['multi_instance']):?>
	<div class="resume-mod-append-instance">
		<a href="" class="resume-mod-append-instance-btn">添加一项</a>
	</div>
	<?php endif;?>
</fieldset>