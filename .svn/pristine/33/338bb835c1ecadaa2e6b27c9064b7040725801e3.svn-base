<?php

/**
 * 模版视图辅助方法
 */
use \LITE\Router;

class ViewHelper
{
	/**
	 * 构建连接
	 * @param string $target
	 * @param array $params
	 */
	public static function url($target = '', $params = array())
	{
		echo Router::getUrl($target, $params);
	}

	/**
	 * 面包屑
	 * @param array $breadcrumb 页面及对应连接
	 */
	public static function breadcrumb($breadcrumb = array())
	{
		$result = '<ul class="breadcrumb">';
		$count = count($breadcrumb);
		foreach ($breadcrumb as $title => $url) {
			if ((--$count) > 0) {
				$result .= '<li><a href="' . Router::getUrl($url) . '">' . $title . '</a></li>';
			} else {
				$result .= '<li class="active">' . $title . '</li>';
			}
		}
		$result .= '</ul>';
		echo $result;
	}

	/**
	 * 标签
	 * @param $status 状态
	 * @param $text   文本
	 */
	public static function label($status, $text)
	{
		$result = '<span class="label label-' . $status . '">' . $text . '</span>';
		echo $result;
	}

	/**
	 * 包含模块文件
	 * @param string $module 模块名称
	 */
	public static function inc($module = '')
	{
		$file = '/template/inc/' . $module . '.inc.php';
		include $file;
	}

	/**
	 * 加载自定义的JS文件
	 * @param string $js 要加载的js文件相对路径,多个之间以,分隔
	 */
	public static function js($js /*, $js2, $js3...*/)
	{
		$args = func_get_args();
		$result = '';
		foreach ($args as $js) {
			if (gettype($js) == 'string') {
				$result .= self::load_resource($js, 'js');
			} else {
				foreach ($js_arr as $key => $val) {
					$result .= self::load_resource($val, 'js');
				}
			}
		}
		echo $result;
	}

	/**
	 * 加载自定义的CSS文件
	 * @param string $css 要加载的css文件相对路径,多个之间以,分隔
	 */
	public static function css($css /*, $css2, $css3...*/)
	{
		$args = func_get_args();
		$result = '';
		foreach ($args as $css) {
			if (gettype($css) == 'string') {
				$result .= self::load_resource($css, 'css');
			} else {
				foreach ($css_arr as $key => $val) {
					$result .= self::load_resource($val, 'css');
				}
			}
		}
		echo $result;
	}

	/**
	 * 加载图片文件
	 *
	 * @param string $img
	 */
	public static function img($img = '')
	{
		if (!empty($img)) {
			echo self::load_resource($img, 'img');
		}
	}

	/**
	 * 构建资源
	 * @param $file
	 * @param $type
	 * @return string
	 */
	public static function load_resource($file, $type)
	{
		$BASE_STATIC_URL = 'http://s.thcdn.cn/htadmin';
		$path = $BASE_STATIC_URL . '/' . $type . '/' . $file;
		//$version = substr(md5_file($path), 0, 8);
		//$path .= '?v=' . $version; // 取文件md5码前8位作为版本号

		if (!empty($file) && !empty($type)) {
			$result = '';
			if ($type == 'js') {
				$result = '<script src="' . $path . '"></script>' . "\n\r";
			} elseif ($type == 'css') {
				$result = '<link rel="stylesheet" href="' . $path . '" />' . "\n\r";
			} elseif ($type == 'jpg' || $type == 'jpeg' || $type == 'png' || $type == 'gif' || $type == 'bmp') {
				$result .= $path;
			}

			return $result;
		}
	}
}